<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>TGLFS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link href="./style.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" href="./icons/TGLFS logo 192.png" sizes="192x192" type="image/png" />
    <link rel="manifest" href="./manifest.json" />
    <script type="module" src="web/app.ts"></script>
</head>

<body class="text-center">
    <div id="app">
        <div id="logo">üóÇÔ∏è</div>
        <h1 id="title" class="h3 mb-3 font-weight-normal">Telegram Large File Storage</h1>
        <div id="splash">Loading...</div>
        <div id="login" hidden>
            <div class="login-card">
                <div class="login-header">
                    <div class="login-kicker">Secure Login</div>
                    <h2 class="login-title">Sign in to TGLFS</h2>
                    <p class="login-subtitle">Use your Telegram account to access your files.</p>
                </div>
                <div id="loginStepIndicator" class="login-step-indicator">Step 1 of 3</div>
                <div id="loginStatus" class="login-status" role="status" aria-live="polite" hidden>
                    <span class="spinner" aria-hidden="true"></span>
                    <span id="loginStatusText"></span>
                </div>
                <div id="loginError" class="login-error" role="alert" aria-live="assertive" hidden></div>
                <form id="loginPhoneForm" class="login-step" autocomplete="on">
                    <label class="form-label" for="phone">Phone number</label>
                    <input type="tel" id="phone" class="form-control" name="phone" placeholder="+1 555 555 5555"
                        autocomplete="tel" inputmode="tel" />
                    <button id="loginButton" type="submit" class="btn btn-lg btn-primary btn-block w-100">Send code</button>
                    <p class="login-hint">We will send a login code via Telegram.</p>
                </form>
                <form id="loginCodeForm" class="login-step" autocomplete="one-time-code" hidden>
                    <label class="form-label" for="loginCode">Login code</label>
                    <input type="text" id="loginCode" class="form-control" placeholder="12345" inputmode="numeric"
                        autocomplete="one-time-code" />
                    <div class="login-action-row">
                        <button id="loginCodeSubmit" type="submit" class="btn btn-primary w-100">Verify code</button>
                        <button id="loginPasteCode" type="button" class="btn btn-outline-secondary w-100">Paste code</button>
                    </div>
                    <div class="login-link-row">
                        <a id="loginOpenTelegram" class="btn btn-link" href="tg://">Open Telegram</a>
                        <button id="loginChangePhone" type="button" class="btn btn-link">Change phone</button>
                    </div>
                    <p class="login-hint">Codes usually arrive within a few seconds.</p>
                </form>
                <form id="loginPasswordForm" class="login-step" hidden>
                    <label class="form-label" for="loginPassword">Telegram password</label>
                    <input type="password" id="loginPassword" class="form-control" autocomplete="current-password" />
                    <button id="loginPasswordSubmit" type="submit" class="btn btn-primary w-100">Continue</button>
                    <div class="login-link-row">
                        <button id="loginResetLogin" type="button" class="btn btn-link">Use a different number</button>
                    </div>
                    <p class="login-hint">This is your Telegram two-step verification password.</p>
                </form>
            </div>
        </div>
        <div id="controls" class="button-group" hidden>
            <input type="file" id="uploadFileInput" multiple style="display: none !important;" />
            <button id="fileBrowserButton" class="btn btn-lg btn-outline-primary btn-block w-100">
                File Browser
            </button>
            <button id="downloadFileLegacyButton" class="btn btn-lg btn-outline-primary btn-block w-100">
                Download (Legacy)
            </button>
            <button id="logoutButton" class="btn btn-lg btn-outline-secondary btn-block w-100">
                Log out
            </button>
        </div>
        <div id="progressBarContainer" hidden>
            <div id="progressBarText"></div>
            <div id="progressBar" class="progress text-center">
                <div id="progress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"
                    style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
            </div>
            <div id="progressBytesText" class="text-muted">0 / 0 bytes</div>
            <div id="progressTimeText" class="text-muted">Elapsed: 00:00:00 ‚Ä¢ Remaining: --:--:--</div>
        </div>
        <div id="fileBrowser" hidden>
            <div class="fx-header">
                <div class="fx-header-row">
                    <button id="browserHomeButton" class="btn btn-sm btn-outline-secondary fx-logo-button" aria-label="Home">
                        <img src="./icons/TGLFS logo 192.png" alt="TGLFS" class="fx-logo-img" />
                    </button>
                    <div class="btn-group view-toggle" role="group">
                        <button id="viewList" class="btn btn-sm btn-outline-secondary active" title="List">‚ò∞</button>
                        <button id="viewGrid" class="btn btn-sm btn-outline-secondary" title="Grid">‚ñ¶</button>
                    </div>
                    <input id="browserSearchInput" class="form-control form-control-sm fx-search"
                        placeholder="Search..." />
                    <select id="browserSortSelect" class="form-select form-select-sm fx-sort">
                        <option value="date_desc">Newest</option>
                        <option value="date_asc">Oldest</option>
                        <option value="name_asc">A‚ÄìZ</option>
                        <option value="name_desc">Z‚ÄìA</option>
                        <option value="size_desc">Largest</option>
                        <option value="size_asc">Smallest</option>
                    </select>
                    <div class="fx-actions">
                        <button id="browserActionUpload" class="btn btn-sm btn-primary fx-action-btn">+ Upload</button>
                        <button id="browserActionReceive" class="btn btn-sm btn-outline-primary fx-action-btn">Receive</button>
                        <div class="dropdown fx-actions-dropdown">
                            <button id="browserQuickActionsBtn" class="btn btn-sm btn-primary dropdown-toggle" type="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Actions
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#" id="browserActionUploadItem">+ Upload</a></li>
                                <li><a class="dropdown-item" href="#" id="browserActionReceiveItem">Receive</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div id="browserContent" class="browser-content">
                <div id="browserList">
                    <div class="table-responsive">
                        <table id="browserTable" class="table table-hover align-middle fade-in">
                            <thead>
                                <tr>
                                    <th class="name">Name</th>
                                    <th class="size">Size</th>
                                    <th class="ufid">UFID</th>
                                    <th class="date">Date</th>
                                    <th class="status">Status</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div id="browserCards" class="fade-in d-lg-none"></div>
                </div>
                <div id="browserGrid" class="file-grid fade-in" hidden></div>
                <div class="d-flex justify-content-between align-items-center" style="margin-top: 16px;">
                    <button id="browserPrevPage" class="btn btn-secondary" title="Previous Page">‚Üê</button>
                    <div id="browserPageInfo" class="text-muted"></div>
                    <button id="browserNextPage" class="btn btn-secondary" title="Next Page">‚Üí</button>
                </div>
            </div>
            <div class="fx-footer">
                <!-- File actions (shown when files selected) -->
                <div class="browser-actions" id="fileActionsBar" hidden>
                    <div class="d-flex flex-wrap gap-2 align-items-center">
                        <span id="selectionInfo" class="text-muted small"></span>
                        <button id="deselectAllBtn" class="btn btn-sm btn-link text-muted p-0">Clear selection</button>
                    </div>
                    <div class="d-flex flex-wrap gap-1">
                        <button id="browserActionPreview" class="btn btn-sm btn-secondary">Preview</button>
                        <button id="browserActionDownload" class="btn btn-sm btn-primary">Download</button>
                        <button id="browserActionRename" class="btn btn-sm btn-secondary">Rename</button>
                        <button id="browserActionSend" class="btn btn-sm btn-secondary">Send</button>
                        <button id="browserActionDelete" class="btn btn-sm btn-danger">Delete</button>
                    </div>
                </div>
                <!-- Mobile dropdown for file actions -->
                <div class="browser-actions-dropdown" id="fileActionsDropdown" hidden>
                    <div class="d-flex gap-2 align-items-center justify-content-between">
                        <button id="selectAllBtnMobile" class="btn btn-sm btn-outline-secondary">Clear selection</button>
                        <div class="dropdown">
                            <button id="browserActionsBtn" class="btn btn-sm btn-primary dropdown-toggle" type="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Actions
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#" id="actionPreviewItem">üëÅÔ∏è Preview</a></li>
                                <li><a class="dropdown-item" href="#" id="actionDownloadItem">‚¨áÔ∏è Download</a></li>
                                <li><a class="dropdown-item" href="#" id="actionRenameItem">‚úèÔ∏è Rename</a></li>
                                <li><a class="dropdown-item" href="#" id="actionSendItem">üì§ Send</a></li>
                                <li>
                                    <hr class="dropdown-divider" />
                                </li>
                                <li><a class="dropdown-item text-danger" href="#" id="actionDeleteItem">üóëÔ∏è Delete</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Hidden: Unsend button (only for received files) -->
                <button id="browserActionUnsend" class="btn btn-danger" hidden>Unsend</button>
            </div>
        </div>
        <div id="ufidToast" class="ufid-toast" role="status" aria-live="polite" aria-hidden="true">
            UFID copied to clipboard
        </div>
        <div id="previewModal" class="preview-modal" hidden>
            <div class="preview-backdrop"></div>
            <div class="preview-content">
                <button class="preview-close" aria-label="Close">√ó</button>
                <div id="previewLoading" class="preview-loading">
                    <div class="spinner"></div>
                    <p id="previewLoadingText">Downloading...</p>
                    <div class="progress">
                        <div id="previewProgress" class="progress-bar" style="width: 0%"></div>
                    </div>
                    <button id="previewCancel" class="btn btn-secondary">Cancel</button>
                </div>
                <div id="previewMediaContainer" hidden>
                    <img id="previewImage" hidden />
                    <video id="previewVideo" controls hidden></video>
                    <audio id="previewAudio" controls hidden></audio>
                </div>
                <div class="preview-info">
                    <h3 id="previewFileName"></h3>
                    <p id="previewFileMeta"></p>
                </div>
            </div>
        </div>
        <div id="donation" class="text-muted" style="margin-top: 64px">
            Support development! BTC donation address:<br /><code
                style="word-wrap: break-word; user-select: text">bc1q5kqen6ygnrqxgtyqyfpgsefnuj20rrfp6tg3dm</code>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>
